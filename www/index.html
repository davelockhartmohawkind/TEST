
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Price Calculator</title>
		<link rel="stylesheet" href="themes/MohawkPriceCalc2.min.css" />
		<!--<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile.structure-1.3.2.min.css" />
		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>-->

        <link rel="stylesheet" href="css/jquery.mobile.structure-1.3.2.css" />
		<script src="js/jquery-1.9.1.min.js"></script>
		<script src="js/jquery.mobile-1.3.2.min.js"></script>
        <script type="text/javascript" src="phonegap.js"></script>
        <script type="text/javascript" src="js/index.js"></script>

	</head>
	<body>
		<div data-role="page" data-theme="a">

            <div data-role="collapsible"  > <!--collapsible-->
                <h4>Dealer</h4>
    
			    <div data-role="header" data-position="inline">
				<!--<h1>Dealer Settings</h1>-->
			    </div>
			    <div data-role="content" data-theme="a"> <!--content-->
	                       <a href="MustSelectDealer.html" data-rel="dialog" data-transition="flip">Detailed Instructions</a>
                    <div  data-role="fieldcontain" >
                        <label for="selectDealerSelection">Dealer Selection:</label>
                        <select id="selectDealerSelection" name="selectDealerSelection"  data-inline="true" >
                           <!-- <option value="1">Bobs Carpet</option>
                            <option value="2">Jacks Carpet</option>
                            <option value="3" selected="selected">Freds Carpet</option>
                            <option value="4">Teds Carpet</option>-->
                        </select>
                   </div>
                   <div data-role="fieldcontain"  >
                        <label >New Dealer:</label>
                        <fieldset data-role="controlgroup"  data-type="horizontal" >
				        <legend>&nbsp;</legend>
 
                        <a href="#"  id="inputBtnAdd" data-role="button"  data-icon="add" data-iconpos="right" data-inline="true" data-theme="b" >Add Dealer</a>
                        <input id="inputDealerSelection" type="text" placeholder="Dealer Name" class="ui-hidden-accessible"   />
                        </fieldset>
                    </div>

                    <div data-role="fieldcontain">
                        <label >Profit Type:</label>
                        <fieldset data-role="controlgroup"  data-type="horizontal" >
				            <legend>&nbsp;</legend>
				            <input type="radio" name="radioFormula" id="radioMarkup" value="Markup" checked="checked" />
				            <label for="radioMarkup">Markup</label>
				            <input type="radio" name="radioFormula" id="radioProfitMargin" value="Margin"  />
				            <label for="radioProfitMargin">Margin</label>
                            <!-- <input type="text" placeholder="% of profit" size="15"/>-->
                           <!--  <label for="slider1">Profit Amount:</label>
				            <input type="range" name="slider1" id="Range1" value="50" min="0" max="100" data-theme="a" />-->
                        </fieldset> 
                     </div> <!--field contain-->

                    <div data-role="fieldcontain"   >
                         
                        <label >Percent %:</label>
                         <fieldset data-role="controlgroup"  data-type="horizontal" >
                    
                           <legend>&nbsp;</legend>
				       <!-- <label for="inputProfitMarginOrMarkup">test</label>-->
				        <input type="range" name="inputProfitMarginOrMarkup" id="inputProfitMarginOrMarkup" min="0" max="100" data-theme="a"  step=".1" value="40" />
                              </fieldset>
                      <!--  <label for="slider1">Mark Up %:</label>-->
				      <!--  <input class="ui-hidden-accessible" type="range" name="inputMarkUp" id="inputMarkup" min="0" max="100" data-theme="a"  step=".1" value="40" />-->
                           <!-- </fieldset>-->
                    </div> <!--field contain-->

                    <div data-role="fieldcontain" >
                        <label>Profit Method:</label>
				            <fieldset data-role="controlgroup"  data-type="horizontal" >
				            <legend>&nbsp;</legend>
				            <input type="radio" name="radioCarpetOnlyOrInstalled" id="radioCarpetOnly" value="CarpentOnly" checked="checked" />
				            <label for="radioCarpetOnly">Carpet Only</label>
				            <input type="radio" name="radioCarpetOnlyOrInstalled" id="radioInstalled" value="Installed"  />
				            <label for="radioInstalled">Installed</label>
				            </fieldset>
                    </div> <!--field contain-->

                    <div data-role="fieldcontain">
                        <label>Add Profit To:</label>
                        <fieldset data-role="controlgroup">
	                       <legend>&nbsp;</legend>
	                      
                            <input type="checkbox" name="checkboxCushion" id="checkboxCushion" class="custom"  />
	                       <label for="checkboxCushion">Cushion Cost</label>
                            
                           <input type="checkbox" name="checkboxInstallation" id="checkboxInstallation" class="custom" />
                           
	                       <label for="checkboxInstallation">Installation</label>

                           <input type="checkbox" name="checkboxFreight" id="checkboxFreight" class="custom" />
	                       <label for="checkboxFreight">Freight</label>

                           <input type="checkbox" name="checkboxOther" id="checkboxOther" class="custom" checked />
	                       <label for="checkboxOther">Other</label>
                        
                        </fieldset>
                    </div><!--field contain-->
                     <div data-role="fieldcontain">
                         <label>Cost:</label>
                        <fieldset data-role="controlgroup">
                            <legend>&nbsp;</legend>
                        
                            <label for="inputCushion">Cushion Cost</label>
                            <input id="inputCushion" type="number" value="0.00"   />
                            
                            <label for="inputInstallation">Installation</label>
                            <input id="inputInstallation" type="number" value="0.00"   />
                            
                            <label for="inputFreight">Freight</label>
                            <input id="inputFreight" type="number"  value="0.00" />
                            
                            <label for="inputOther">Other</label>
                            <input id="inputOther" type="number" value="0.00"  />
                         
                        </fieldset>
                     </div> <!--field contain-->
                    <div data-role="fieldcontain" style="text-align:center" ><!--buttons -->
                       <!-- <a href="#" id="inputBtnAdd" data-role="button" data-inline="true">Add</a>-->
                        
                        <div data-role="popup" id="popUpEnterDealerName" data-overlay-theme="b">
                                <p>Enter a Dealer Name Please<p>
                        </div>
                        <a href="#" id="inputBtnSave"data-role="button" data-inline="true">Save</a>
                        <a href="#" id="inputBtnDelete"data-role="button" data-inline="true">Delete</a>
                        <a href="#" id="inputBtnCancel"data-role="button" data-inline="true">Cancel</a>

                    </div> <!--buttons-->
                 
                 </div> <!--content-->
            </div><!--collapsible-->

            <div data-role="collapsible"> <!--collapsible-->
                <h4>Wholesale</h4>
                <h3><a href="." data-rel="external" id="headerWholesaleDealerName">No Dealer Selected</a></h3>
                <p id="headerWholesaleDealerDetails">No Details </p>

                <table data-role="table" id="tableWholesale" data-mode="reflow" class="ui-responsive table-stroke">
                  <thead>
                    <tr>
                      <th data-priority="1">Product</th>
                      <th data-priority="persist">Wholesale</th>
                      <th data-priority="2">Retail&nbsp;(yd)</th>
                      <th data-priority="3"><abbr title="Rotten Tomato Rating">Retail&nbsp;(ft)</abbr></th>
                      <th data-priority="4">Action</th>
                    </tr>
                  </thead>
                  <tbody id="tbodyWholesale">
                   <!-- <tr>-->

                 <!--    <tr>
                      <th><a href="." data-rel="external">Product1</a></th>
                      <td>$7.25</td>
                      <td>$12.95</td>
                      <td>$2.22</td>
                      <td><a href="#" data-role="button" data-icon="delete" data-iconpos="right" data-inline="true"></a></td>
                    </tr>
                    <tr>
                      <th><a href="." data-rel="external">Product2</a></th>
                      <td>$7.25</td>
                      <td>$12.95</td>
                      <td>$2.22</td>
                      <td><a href="#" data-role="button" data-icon="delete" data-iconpos="right" data-inline="true"></a></td>
                    </tr>
                    <tr>
                      <th><a href="." data-rel="external">Product3</a></th>
                      <td>$7.25</td>
                      <td>$12.95</td>
                      <td>$2.22</td>
                      <td><a href="#" data-role="button" data-icon="delete" data-iconpos="right" data-inline="true"></a></td>
                    </tr>
                    <tr>
                      <th><input  type="text"  placeholder="Optional Product"  /></th>
                      <td><input  type="text"  placeholder="Enter Wholesale $0.00"  /></td>
                      <td>$0.00</td>
                      <td>$0.00</td>
                      <td><button class="show-page-loading-msg" data-textonly="false" data-textvisible="true" data-msgtext="Processing" data-role="button" data-icon="add" data-iconpos="right" data-inline="true" data-theme="b" >Add</button>
                   
                        
                            

                      </td>
                    </tr>-->
                  </tbody>
               </table>
            </div> <!--collapsible-->
               <!-- Use this for hiding the progress spinner
                              <button class="hide-page-loading-msg" data-inline="true" data-icon="delete">Hide</button> -->
            <div data-role="collapsible"> <!--collapsible-->
                <h4>Retail</h4>
                <h3><a href="." id="headerRetailDealerName" data-rel="external">No Dealer Selected</a></h3>
                <p id="headerRetailDealerDetails" >No Details</p>

                <table data-role="table" id="tableRetail" data-mode="reflow" class="ui-responsive table-stroke">
                  <thead>
                    <tr>
                      <th data-priority="1">Product</th>
                      <th data-priority="persist">Retail</th>
                      <th data-priority="2">Wholesale&nbsp;(yd)</th>
                      <th data-priority="3"><abbr title="Rotten Tomato Rating">Wholesale&nbsp;(ft)</abbr></th>
                      <th data-priority="4">Action</th>
                    </tr>
                  </thead>
                  <tbody id="tbodyRetail" >
                   <!-- <tr>-->

                    <!-- <tr>
                      <th><a href="." data-rel="external">Product1</a></th>
                      <td>$7.25</td>
                      <td>$12.95</td>
                      <td>$2.22</td>
                      <td><a href="#" data-role="button" data-icon="delete" data-iconpos="right" data-inline="true">Del</a></td>
                    </tr>
                    <tr>
                      <th><a href="." data-rel="external">Product2</a></th>
                      <td>$7.25</td>
                      <td>$12.95</td>
                      <td>$2.22</td>
                      <td><a href="#" data-role="button" data-icon="delete" data-iconpos="right" data-inline="true">Del</a></td>
                    </tr>
                    <tr>
                      <th><a href="." data-rel="external">Product3</a></th>
                      <td>$7.25</td>
                      <td>$12.95</td>
                      <td>$2.22</td>
                      <td><a href="#" data-role="button" data-icon="delete" data-iconpos="right" data-inline="true">Del</a></td>
                    </tr>
                    <tr>
                      <th><input  type="text"  placeholder="Optional Product"  /></th>
                      <td><input  type="text"  placeholder="Enter Wholesale $0.00"  /></td>
                      <td>$0.00</td>
                      <td>$0.00</td>
                      <td><a href="#" data-role="button" data-icon="add" data-iconpos="right" data-inline="true" data-theme="b" >Add</a></td>
                    </tr>-->
                  </tbody>
               </table>
            </div> <!--collapsible-->


		
            </div><!-- page-->


          <script >
              $(document).ready(function () {

                  $(document).on("click", ".show-page-loading-msg", function () {
                      var $this = $(this),
                          theme = $this.jqmData("theme") || $.mobile.loader.prototype.options.theme,
                          msgText = $this.jqmData("msgtext") || $.mobile.loader.prototype.options.text,
                          textVisible = $this.jqmData("textvisible") || $.mobile.loader.prototype.options.textVisible,
                          textonly = !!$this.jqmData("textonly");
                      html = $this.jqmData("html") || "";
                      $.mobile.loading("show", {
                          text: msgText,
                          textVisible: textVisible,
                          theme: theme,
                          textonly: textonly,
                          html: html
                      });
                  })

                  .on("click", ".hide-page-loading-msg", function () {
                      $.mobile.loading("hide");
                  });



                  $("#selectDealerSelection").change(onSelectDealer);

                  $('#inputBtnAdd').click(onAddDealerBtnClick);
                  $('#inputBtnSave').click(onSaveDealerClick);
                  $('#inputBtnCancel').click(onCancelDealerClick);
                  $('#inputBtnDelete').click(onDeleteDealerClick);


                  //$('#inputDealerSelection').removeClass("ui-hidden-accessible");

                  //localStorage['mohawkDealers'] = JSON.stringify("");
                  //localStorage['mohawkRetail2'] = JSON.stringify("");
                  //localStorage['mohawkRetail'] = JSON.stringify("");
                  //localStorage['mohawkWholesale'] = JSON.stringify("");

                 

                  setDealerData("");
              });



              function setRetailData(dealerName) {
                  //get items from storage
                  var RetailPriceCalcs = $.makeArray($.RetailPriceCalc);
                  var data = localStorage['mohawkRetail']

                  var retailYd = 0;
                  var retailYdWithMarkup = 0;
                  var retailFt = 0;
                  var wholesaleYd = 0;


                  var dealerObject = getDealerObject(dealerName);
                  if (dealerObject == null) {
                      //alert("Could not retrieve dealer information");
                      return;
                  }

                  $("#headerRetailDealerName").text(dealerObject.name);


                  if (data == undefined || data == null || data == "") {
                      $("#tbodyRetail").empty();
                      addBlankRetailRow();
                      return;
                  }

                  RetailPriceCalcs = JSON.parse(data);

                  //get matching items
                  var filteredDealer = $.grep(RetailPriceCalcs, function (item) {
                      if (item != null) {
                          return item.dealerName == dealerName;
                      }
                      return 0;
                  });

                  //update UI with data
                  if (filteredDealer.length < 1) {
                      $("#tbodyRetail").empty();
                      addBlankRetailRow();
                      return;
                  }




                  filteredDealer.sort(function (obj1, obj2) {
                      if (obj1 == null) {
                          return true;
                      }
                      if (obj2 == null) {
                          return false;
                      }

                      if (obj1.productName == '') {
                          return true;
                      }

                      if (obj2.productName == '') {
                          return false;
                      }

                      return obj1.productName > obj2.productName;
                  });

                  //$("#selectDealerSelection").empty();
                  $("#tbodyRetail").empty();
                  var intemnumber = 0;
                  $.each(filteredDealer, function (index, retailPriceCalc) {
                      var retailYd = 0;
                      var retailYdWithMarkup = 0;
                      var retailFt = 0;
                      var wholesaleYd = 0;

                      if (retailPriceCalc != null) {
                          //calculate total here
                          wholesaleYd = parseFloat(retailPriceCalc.wholesaleYd);

                          if (dealerObject.usecushion == "true") {
                              //do it
                              retailYdWithMarkup = retailYdWithMarkup + parseFloat(dealerObject.cushion);
                          }
                          else {
                              retailYd = parseFloat(retailYd) + parseFloat(dealerObject.cushion);
                          }


                          if (dealerObject.useinstallation == "true") {
                              //do it
                              retailYdWithMarkup = retailYdWithMarkup + parseFloat(dealerObject.installation)
                          }
                          else {
                              retailYd = parseFloat(retailYd) + parseFloat(dealerObject.installation);
                          }

                          if (dealerObject.usefreight == "true") {
                              //do it
                              retailYdWithMarkup = retailYdWithMarkup + parseFloat(dealerObject.freight)
                          }
                          else {
                              retailYd = parseFloat(retailYd) + parseFloat(dealerObject.freight);
                          }


                          if (dealerObject.useother == "true") {
                              //do it
                              retailYdWithMarkup = retailYdWithMarkup + parseFloat(dealerObject.other)
                          }
                          else {
                              retailYd = parseFloat(retailYd) + parseFloat(dealerObject.other);
                          }

                          var multiplier = 0;
                          var ydWithMarkup = retailYdWithMarkup;
                          var ydWholesale = wholesaleYd;
                          if (dealerObject.useprofit == "true") {
                              //multiplier = parseFloat("1." + dealerObject.profit.toString());
                              multiplier = parseInt(dealerObject.profit) / 100 + 1;
                          }
                          else {
                              //multiplier = parseFloat(1 - parseFloat("." + dealerObject.markup.replace(".", ""))).toFixed(2);
                              multiplier = (1 - (parseInt(dealerObject.markup) / 100)).toFixed(2);
                          }


                          var total = (((ydWithMarkup + ydWholesale)).toFixed(2) / multiplier).toFixed(2);
                          retailYd = total;



                          retailFt = (retailYd / 9).toFixed(2);
                          addRetailRow(retailPriceCalc.productName, retailPriceCalc.wholesaleYd, retailYd, retailFt, false, true, retailPriceCalc.itemId);
                      }


                  });
                  //add a blank row
                  addBlankRetailRow();

              }



              function setWholesaleData(dealerName) {
                  //get items from storage
                  var WholesalePriceCalcs = $.makeArray($.WholesalePriceCalc);
                  var data = localStorage['mohawkWholesale']

                  var retailYd = 0;
                  var retailYdWithMarkup = 0;
                  var retailFt = 0;
                  var wholesaleYd = 0;
                  var headerDetails = '';

                  var dealerObject = getDealerObject(dealerName);
                  if (dealerObject == null) {
                      // alert("Could not retrieve dealer information");
                      return;
                  }

                  $("#headerWholesaleDealerName").text(dealerObject.name);
                  
                  //if (dealerObject.carpetonly == 'true') {
                  //    headerDetails = headerDetails + 'Carpet Only,';
                  //}

                  //if (dealerObject.useprofit == 'true') {
                  //    headerDetails = headerDetails + 'Margin ' + dealerObject.profit + '% ';
                  //}
                  //else {
                  //    headerDetails == headerDetails + 'Markup ' + dealerObject.markup + '% ';
                  //}

                  //if (dealerObject.carpetonly == 'false') {

                  //    if (dealerObject.usecushion == 'true') {
                  //        headerDetails == headerDetails + ',Cushion ';
                  //    }
                  //    if (dealerObject.useinstallation == 'true') {
                  //        headerDetails == headerDetails + ',Cushion ';
                  //    }
                  //    if (dealerObject.usefreight == 'true') {
                  //        headerDetails == headerDetails + ',Freight ';
                  //    }
                  //    if (dealerObject.useother == 'true') {
                  //        headerDetails == headerDetails + ',Other ';
                  //    }
                  //}
                  

                  //$("#headerWholesaleDealerDetails").text(headerDetails);

                  if (data == undefined || data == null || data == "") {
                      $("#tbodyWholesale").empty();
                      addBlankRow();
                      return;
                  }

                  WholesalePriceCalcs = JSON.parse(data);

                  //get matching items
                  var filteredDealer = $.grep(WholesalePriceCalcs, function (item) {
                      if (item != null) {
                          return item.dealerName == dealerName;
                      }
                      return 0;
                  });

                  //update UI with data
                  if (filteredDealer.length < 1) {
                      $("#tbodyWholesale").empty();
                      addBlankRow();
                      return;
                  }




                  filteredDealer.sort(function (obj1, obj2) {
                      if (obj1 == null) {
                          return true;
                      }
                      if (obj2 == null) {
                          return false;
                      }

                      if (obj1.productName == '') {
                          return true;
                      }

                      if (obj2.productName == '') {
                          return false;
                      }

                      return obj1.productName > obj2.productName;
                  });

                  //$("#selectDealerSelection").empty();
                  $("#tbodyWholesale").empty();
                  var intemnumber = 0;
                  $.each(filteredDealer, function (index, wholesalePriceCalc) {
                      var retailYd = 0;
                      var retailYdWithMarkup = 0;
                      var retailFt = 0;
                      var wholesaleYd = 0;

                      if (wholesalePriceCalc != null) {
                          //calculate total here
                          wholesaleYd = parseFloat(wholesalePriceCalc.wholesaleYd);

                          if (dealerObject.usecushion == "true") {
                              //do it
                              retailYdWithMarkup = retailYdWithMarkup + parseFloat(dealerObject.cushion);
                          }
                          else {
                              retailYd = parseFloat(retailYd) + parseFloat(dealerObject.cushion);
                          }


                          if (dealerObject.useinstallation == "true") {
                              //do it
                              retailYdWithMarkup = retailYdWithMarkup + parseFloat(dealerObject.installation)
                          }
                          else {
                              retailYd = parseFloat(retailYd) + parseFloat(dealerObject.installation);
                          }

                          if (dealerObject.usefreight == "true") {
                              //do it
                              retailYdWithMarkup = retailYdWithMarkup + parseFloat(dealerObject.freight)
                          }
                          else {
                              retailYd = parseFloat(retailYd) + parseFloat(dealerObject.freight);
                          }


                          if (dealerObject.useother == "true") {
                              //do it
                              retailYdWithMarkup = retailYdWithMarkup + parseFloat(dealerObject.other)
                          }
                          else {
                              retailYd = parseFloat(retailYd) + parseFloat(dealerObject.other);
                          }

                          var multiplier = 0;
                          var ydWithMarkup = retailYdWithMarkup;
                          var ydWholesale = wholesaleYd;
                          if (dealerObject.useprofit == "true") {
                              //multiplier = parseFloat("1." + dealerObject.profit.toString());
                              multiplier = parseInt(dealerObject.profit) / 100 + 1;
                          }
                          else {
                              //multiplier = parseFloat(1 - parseFloat("." + dealerObject.markup.replace(".", ""))).toFixed(2);
                              multiplier = (1 - (parseInt(dealerObject.markup) / 100)).toFixed(2);
                          }


                          var total = (multiplier * (ydWithMarkup + ydWholesale)).toFixed(2);
                          retailYd = total;

                          //if (dealerObject.useprofit == "true") {
                          //    retailYd = total;//parseFloat(retailYd) + ((parseFloat(wholesaleYd) + parseFloat(retailYdWithMarkup)) * parseFloat('1.' + dealerObject.profit.replace(".", "")));
                          //}
                          //else {
                          //    retailYd = parseFloat(retailYd) + ((parseFloat(wholesaleYd) + parseFloat(retailYdWithMarkup)) * parseFloat(1 - dealerObject.profit.replace(".", "")));
                          //}

                          retailFt = (retailYd / 9).toFixed(2);
                          addRow(wholesalePriceCalc.productName, wholesalePriceCalc.wholesaleYd, retailYd, retailFt, false, true, wholesalePriceCalc.itemId);
                      }


                  });
                  //add a blank row
                  addBlankRow();

              }

              function saveWholesale(itemId, dealerName, productName, wholesaleYd) {
                  deleteWholesale(dealerName, itemId);

                  addWholesale(itemId, dealerName, productName, wholesaleYd);

              }

              function saveRetail(itemId, dealerName, productName, retailYd) {
                  deleteRetail(dealerName, itemId);

                  addRetail(itemId, dealerName, productName, retailYd);

              }

              function deleteWholesale(dealerName, itemId) {
                  //get items from storage
                  var WholesalePriceCalcs = $.makeArray($.WholesalePriceCalc);
                  var data = localStorage['mohawkWholesale'];
                  var filteredDealer;
                  if (data != undefined && data != null && data != "") {
                      WholesalePriceCalcs = JSON.parse(data);

                      //get matching items
                      var filteredDealer = $.grep(WholesalePriceCalcs, function (item) {
                          if (item != null) {
                              return item.itemId != itemId;
                          }
                          return 0;
                      });

                      //update UI with data
                      //if (filteredDealer.length < 1) {
                      //    //alert(item + " already exist");
                      //    return;
                      //}


                      if (filteredDealer.length > 0) {
                          filteredDealer.sort(function (obj1, obj2) {
                              if (obj1 == null) {
                                  return true;
                              }
                              if (obj2 == null) {
                                  return false;
                              }

                              if (obj1.productname == '') {
                                  return true;
                              }

                              if (obj2.productname == '') {
                                  return false;
                              }

                              return obj1.productName > obj2.productName;
                          });
                      }

                      //save to storage
                      localStorage['mohawkWholesale'] = JSON.stringify(filteredDealer);
                  }
              }


              function deleteWholesaleByDealerName(dealerName) {
                  //get items from storage
                  var WholesalePriceCalcs = $.makeArray($.WholesalePriceCalc);
                  var data = localStorage['mohawkWholesale'];
                  var filteredDealer;
                  if (data != undefined && data != null && data != "") {
                      WholesalePriceCalcs = JSON.parse(data);

                      //get matching items
                      var filteredDealer = $.grep(WholesalePriceCalcs, function (item) {
                          if (item != null) {
                              return item.dealerName != dealerName;
                          }
                          return 0;
                      });

                      //update UI with data
                      if (filteredDealer.length < 1) {
                          //alert(item + " already exist");
                          return;
                      }



                      filteredDealer.sort(function (obj1, obj2) {
                          if (obj1 == null) {
                              return true;
                          }
                          if (obj2 == null) {
                              return false;
                          }

                          if (obj1.productname == '') {
                              return true;
                          }

                          if (obj2.productname == '') {
                              return false;
                          }

                          return obj1.productName > obj2.productName;
                      });


                      //save to storage
                      localStorage['mohawkWholesale'] = JSON.stringify(filteredDealer);
                  }
              }


              function deleteRetail(dealerName, itemId) {
                  //get items from storage
                  var RetailPriceCalcs = $.makeArray($.RetailPriceCalc);
                  // remove all data 
                  //localStorage['mohawkRetail2'] = JSON.stringify("");
                  var data = localStorage['mohawkRetail'];
                  var filteredDealer;
                  if (data != undefined && data != null && data != "") {
                      RetailPriceCalcs = JSON.parse(data);

                      //get matching items
                      var filteredDealer = $.grep(RetailPriceCalcs, function (item) {
                          if (item != null) {
                              return item.itemId != itemId;
                          }
                          return 0;
                      });

                      //update UI with data
                      //if (filteredDealer.length < 1) {
                      //    //alert(item + " already exist");
                      //    return;
                      //}


                      if (filteredDealer.length > 0) {
                          filteredDealer.sort(function (obj1, obj2) {
                              if (obj1 == null) {
                                  return true;
                              }
                              if (obj2 == null) {
                                  return false;
                              }

                              if (obj1.productname == '') {
                                  return true;
                              }

                              if (obj2.productname == '') {
                                  return false;
                              }

                              return obj1.productName > obj2.productName;
                          });
                      }


                      //save to storage
                      localStorage['mohawkRetail'] = JSON.stringify(filteredDealer);
                  }
              }


              function deleteRetailByDealerName(dealerName) {
                  //get items from storage
                  var RetailPriceCalcs = $.makeArray($.RetailPriceCalc);
                  // remove all data 
                  //localStorage['mohawkRetail2'] = JSON.stringify("");
                  var data = localStorage['mohawkRetail'];
                  var filteredDealer;
                  if (data != undefined && data != null && data != "") {
                      RetailPriceCalcs = JSON.parse(data);

                      //get matching items
                      var filteredDealer = $.grep(RetailPriceCalcs, function (item) {
                          if (item != null) {
                              return item.dealerName != dealerName;
                          }
                          return 0;
                      });

                      //update UI with data
                      if (filteredDealer.length < 1) {
                          //alert(item + " already exist");
                          return;
                      }



                      filteredDealer.sort(function (obj1, obj2) {
                          if (obj1 == null) {
                              return true;
                          }
                          if (obj2 == null) {
                              return false;
                          }

                          if (obj1.productname == '') {
                              return true;
                          }

                          if (obj2.productname == '') {
                              return false;
                          }

                          return obj1.productName > obj2.productName;
                      });


                      //save to storage
                      localStorage['mohawkRetail'] = JSON.stringify(filteredDealer);
                  }
              }


              function addWholesale(itemId, dealerName, productName, wholesaleYd) {
                  //get items from storage
                  var retailYd = 0;
                  var retailYdWithMarkup = 0;
                  var retailFt = 0;

                  if (wholesaleYd == null) {
                      wholesaleYd = "0";
                  }


                  var WholesalePriceCalcs = $.makeArray($.WholesalePriceCalc);
                  var data = localStorage['mohawkWholesale']

                  if (data != undefined && data != null && data != "") {


                      WholesalePriceCalcs = JSON.parse(data);

                      var maxID = 0;
                      //get matching items
                      var filteredDealer = $.grep(WholesalePriceCalcs, function (item) {
                          if (item != null) {
                              return item.itemId == itemId;
                          }
                          return 0;
                      });

                      //update UI with data
                      if (filteredDealer.length > 0) {
                          //already exist
                          return;
                      }


                  }
                  if (itemId == null || itemId == "") {
                      itemId = (new Date()).getTime();
                  }

                  //create new item
                  var myPriceCalc = new $.WholesalePriceCalc(dealerName, productName, wholesaleYd, '0', '0', itemId);
                  WholesalePriceCalcs.push(myPriceCalc);




                  WholesalePriceCalcs.sort(function (obj1, obj2) {
                      if (obj1 == null) {
                          return true;
                      }
                      if (obj2 == null) {
                          return false;
                      }

                      if (obj1.productname == '') {
                          return true;
                      }

                      if (obj2.productname == '') {
                          return false;
                      }

                      return obj1.productName > obj2.productName;
                  });


                  //save to storage
                  localStorage['mohawkWholesale'] = JSON.stringify(WholesalePriceCalcs);





              }


              function addRetail(itemId, dealerName, productName, retailYd) {
                  //get items from storage
                  // var retailYd = 0;
                  var retailYdWithMarkup = 0;
                  var retailFt = 0;

                  if (retailYd == null) {
                      retailYd = "0";
                  }

                  //var dealerObject = getDealerObject(dealerName);
                  //if (dealerObject == null) {
                  //    alert("Could not retrieve dealer information");
                  //    return;
                  //}

                  var RetailPriceCalcs = $.makeArray($.RetailPriceCalc);
                  var data = localStorage['mohawkRetail']

                  if (data != undefined && data != null && data != "") {


                      RetailPriceCalcs = JSON.parse(data);

                      var maxID = 0;
                      //get matching items
                      var filteredDealer = $.grep(RetailPriceCalcs, function (item) {
                          if (item != null) {
                              return item.itemId == itemId;
                          }
                          return 0;
                      });

                      //update UI with data
                      if (filteredDealer.length > 0) {
                          //already exist
                          return;
                      }

                  }




                  if (itemId == null || itemId == "") {
                      itemId = (new Date()).getTime();
                  }

                  //create new item
                  var myPriceCalc = new $.RetailPriceCalc(dealerName, productName, retailYd, '0', '0', itemId);
                  RetailPriceCalcs.push(myPriceCalc);




                  RetailPriceCalcs.sort(function (obj1, obj2) {
                      if (obj1 == null) {
                          return true;
                      }
                      if (obj2 == null) {
                          return false;
                      }

                      if (obj1.productname == '') {
                          return true;
                      }

                      if (obj2.productname == '') {
                          return false;
                      }

                      return obj1.productName > obj2.productName;
                  });


                  //save to storage
                  localStorage['mohawkRetail'] = JSON.stringify(RetailPriceCalcs);
              }



              function onWholesaleCostSaveButtonClick() {
                  var myArray = this.id.split('_');
                  var dealerName = $("#selectDealerSelection").val();
                  var productName = $("#wholesaleProduct_" + myArray[1]).val();
                  var wholesaleYd = $("#wholesaleCost_" + myArray[1]).val();
                  var itemId =  myArray[1];
                  if (dealerName == "") {
                      alert("Please select a dealer");
                      return;
                  }
                  if (wholesaleYd == "") {
                      alert("Please enter wholesale amount");
                      return;
                  }
                  if (productName == "") {
                      productName = itemId;

                  }

                  saveWholesale(itemId, dealerName, productName, wholesaleYd);
                  setDealerData(dealerName);

              }

              function onRetailCostSaveButtonClick() {
                  var myArray = this.id.split('_');
                  var dealerName = $("#selectDealerSelection").val();
                  var productName = $("#retailProduct_" + myArray[1]).val();
                  var retailYd = $("#retailCost_" + myArray[1]).val();
                  var itemId =  myArray[1];
                  if (dealerName == "") {
                      alert("Please select a dealer");
                      return;
                  }
                  if (retailYd == "") {
                      alert("Please enter retail amount");
                      return;
                  }
                  if (productName == "") {
                      productName = itemId;

                  }

                  saveRetail(itemId, dealerName, productName, retailYd);
                  // setWholesaleData(dealerName);
                  //addRow('', '0.00', '0.00', '0.00', true, false);
                  setDealerData(dealerName);

              }

              function addBlankRow() {
                  addRow('', '0.00', '0.00', '0.00', true, false, '');
              }

              function addBlankRetailRow() {
                  addRetailRow('', '0.00', '0.00', '0.00', true, false, '');
              }

              function addRow(wholesaleProduct, wholesaleAmount, retailYd, retailFt, boolIncludeSave, boolIncludeDelete, itemId) {

                  //var index = parseInt($("#inputAddRowIndex").val());
                  //index = index + 1;
                  //$("#inputAddRowIndex").val(index);

                  if (itemId == null || itemId == "") {
                      itemId = (new Date()).getTime();
                      //itemId = itemId + '_' + index;
                  }



                  var mytable = '<tr>';

                  if (boolIncludeSave) {
                      mytable = mytable + ' <th> <input  id="wholesaleProduct_' + itemId + '" type="text"  placeholder="Optional Product"  /></th>';

                  } else {
                    
                      mytable = mytable + ' <th>  <a href="." data-rel="external">' + wholesaleProduct + '</a></th>';
                  }

                  if (boolIncludeSave) {
                      mytable = mytable + ' <td><input  id="wholesaleCost_' + itemId + '"  type="text"  placeholder="Enter Wholesale $0.00"  value="' + wholesaleAmount + '"  /></td>';
                  }
                  else {
                      mytable = mytable + ' <td> ' + wholesaleAmount + '</td>';
                  }
                  mytable = mytable + ' <td>$' + retailYd + '</td>';
                  mytable = mytable + ' <td>$' + retailFt + '</td>';


                  if (boolIncludeDelete) {
                      mytable = mytable + '<td><a id="btnwholesaleCostDelete_' + itemId + '" href="#" data-role="button" data-icon="delete" data-iconpos="right" data-inline="true"></a></td>';
                  }

                  if (boolIncludeSave) {
                      mytable = mytable + '<td><button id="btnwholesaleCostSave_' + itemId + '"  data-role="button" data-icon="add" data-iconpos="right" data-inline="true" data-theme="b" >Add</button></td>';
                  }
                  mytable = mytable + '               </tr> ';


                  $("#tbodyWholesale").append(mytable);


                  $("#btnwholesaleCostSave_" + itemId).click(onWholesaleCostSaveButtonClick);
                  $("#btnwholesaleCostDelete_" + itemId).click(onWholesaleCostDeleteButtonClick);
                  //$("#wholesaleCost_" + index).inputtext("refresh");
                  // $("#wholesaleCost_" + index).input("refresh");
                  if (boolIncludeSave) {
                      //$("#tableWholesale").table("refresh");
                      $("#tableWholesale").trigger("create");

                  }

              }


              function addRetailRow(retailProduct, retailAmount, wholesaleYd, wholesaleFt, boolIncludeSave, boolIncludeDelete, itemId) {

                  if (itemId == null || itemId == "") {
                      itemId = (new Date()).getTime();
                      //itemId = itemId + '_' + index;
                  }

                  var mytable = '<tr>';

                  if (boolIncludeSave) {
                      mytable = mytable + ' <th> <input  id="retailProduct_' + itemId + '" type="text"  placeholder="Optional Product"  /></th>';

                  } else {

                      mytable = mytable + ' <th>  <a href="." data-rel="external">' + retailProduct + '</a></th>';
                  }

                  if (boolIncludeSave) {
                      mytable = mytable + ' <td><input  id="retailCost_' + itemId + '"  type="text"  placeholder="Enter Retail $0.00"  value="' + retailAmount + '"  /></td>';
                  }
                  else {
                      mytable = mytable + ' <td> ' + retailAmount + '</td>';
                  }
                  mytable = mytable + ' <td>$' + wholesaleYd + '</td>';
                  mytable = mytable + ' <td>$' + wholesaleFt + '</td>';


                  if (boolIncludeDelete) {
                      mytable = mytable + '<td><a id="btnretailCostDelete_' + itemId + '" href="#" data-role="button" data-icon="delete" data-iconpos="right" data-inline="true"></a></td>';
                  }

                  if (boolIncludeSave) {
                      mytable = mytable + '<td><button id="btnretailCostSave_' + itemId + '"  data-role="button" data-icon="add" data-iconpos="right" data-inline="true" data-theme="b" >Add</button></td>';
                  }
                  mytable = mytable + '               </tr> ';


                  $("#tbodyRetail").append(mytable);


                  $("#btnretailCostSave_" + itemId).click(onRetailCostSaveButtonClick);
                  $("#btnretailCostDelete_" + itemId).click(onRetailCostDeleteButtonClick);
                  //$("#wholesaleCost_" + index).inputtext("refresh");
                  // $("#wholesaleCost_" + index).input("refresh");
                  if (boolIncludeSave) {
                      //$("#tableWholesale").table("refresh");
                      $("#tableRetail").trigger("create");

                  }


              }

              function clearAll() {
                  $('#selectDealerSelection option:selected').removeAttr('selected');
                  $('#selectDealerSelection').val('');
                  $("#inputDealerSelection").val('');
                  $("#inputProfitMargin").val('0.00');
                  $("#inputMarkup").val('0.00');

                  $("#inputProfitMarginOrMarkup").val('0');
                  setCheckedAttr("radioMarkup", "false");
                  setCheckedAttr("radioProfitMargin", "false");


                  $("#inputCushion").val('0.00');
                  setCheckedAttr("checkboxCushion", 'true');
                  //setDisabledByCheckBox("inputCushion", 'true');

                  $("#inputInstallation").val('0.00');
                  setCheckedAttr("checkboxInstallation", 'true');
                  setDisabledByCheckBox("inputInstallation", 'true');

                  $("#inputFreight").val('0.00');
                  setCheckedAttr("checkboxFreight", 'true');
                  //setDisabledByCheckBox("inputFreight", 'true');

                  $("#inputOther").val('0.00');
                  setCheckedAttr("checkboxOther", 'true');
                  //setDisabledByCheckBox("inputOther", 'true');
              }



              function onWholesaleCostDeleteButtonClick() {
                  var myArray = this.id.split('_');
                  var dealerName = $("#selectDealerSelection").val();
                  var productName = $("#wholesaleProduct_" + myArray[1]).val();
                  // var wholesaleCost = $("#wholesaleCost_" + myArray[1]).val();
                  var itemId =  myArray[1];

                  deleteWholesale(dealerName, itemId);
                  // setWholesaleData(dealerName)
                  setDealerData(dealerName);
              }

              function onRetailCostDeleteButtonClick() {
                  var myArray = this.id.split('_');
                  var dealerName = $("#selectDealerSelection").val();
                  var productName = $("#retailProduct_" + myArray[1]).val();
                  // var wholesaleCost = $("#wholesaleCost_" + myArray[1]).val();
                  var itemId = $("#retailItemId_" + myArray[1]).val();

                  deleteRetail(dealerName, itemId);
                  // setWholesaleData(dealerName)
                  setDealerData(dealerName);
              }


              function onSelectDealer() {
                  $("#inputDealerSelection").val($("#selectDealerSelection :selected").text());
                  //$("#inputDealerSelection").textinput()
                  //$("#inputDealerSelection").attr('hidden', 'hidden');
                  //$("#inputDealerSelection").textinput({ disabled: true });
                  setDealerData($("#selectDealerSelection :selected").text());

              }

              function onAddDealerBtnClick() {
                  $('#selectDealerSelection').addClass("ui-hidden-accessible");

                  clearAll();
                  $('#selectDealerSelection option:selected').removeAttr('selected');
                  $('#selectDealerSelection').val('');
                  $("#selectDealerSelection").selectmenu("refresh");

                  $('#inputBtnAdd').addClass("ui-hidden-accessible"); //hide button
                  $('#inputDealerSelection').removeClass("ui-hidden-accessible"); //unhide input text
              }


              $.WholesalePriceCalc = function (dealerName, productName, wholesaleYd, retailYd, retailFt, itemId) {

                  this.dealerName = dealerName
                  this.productName = productName;
                  this.wholesaleYd = wholesaleYd;
                  this.retailYd = retailYd;
                  this.retailFt = retailFt;
                  this.itemId = itemId;
              }

              $.RetailPriceCalc = function (dealerName, productName, wholesaleYd, retailYd, retailFt, itemId) {
                  this.dealerName = dealerName
                  this.productName = productName;
                  this.wholesaleYd = wholesaleYd;
                  this.retailYd = retailYd;
                  this.retailFt = retailFt;
                  this.itemId = itemId;
              }


              $.Dealer = function (name, profit, markup, useprofit, carpetonly, cushion, usecushion, installation, useinstallation, freight, usefreight, other, useother) {
                  this.name = name;
                  this.profit = profit;
                  this.markup = markup;
                  this.useprofit = useprofit;
                  this.carpetonly = carpetonly;
                  this.cushion = cushion;
                  this.usecushion = usecushion;
                  this.installation = installation;
                  this.useinstallation = useinstallation;
                  this.freight = freight;
                  this.usefreight = usefreight;
                  this.other = other;
                  this.useother = useother;
              }


              function setDealerData(dealerName) {

                  //get Dealers from storage
                  var Dealers = $.makeArray($.Dealer);
                  var data = localStorage['mohawkDealers']

                  $('#selectDealerSelection').removeClass("ui-hidden-accessible");
                  $('#inputDealerSelection').addClass("ui-hidden-accessible");
                  $('#inputBtnAdd').removeClass("ui-hidden-accessible");

                  if (data == undefined || data == null || data == "") {
                      return null;
                  }

                  Dealers = JSON.parse(data);

                  Dealers.sort(function (obj1, obj2) {
                      if (obj1 == null) {
                          return true;
                      }
                      if (obj2 == null) {
                          return false;
                      }

                      if (obj1.name == '') {
                          return true;
                      }

                      if (obj2.name == '') {
                          return false;
                      }

                      return obj1.name > obj2.name;
                  });


                  //build select 
                  $("#selectDealerSelection").empty();
                  if (dealerName == '') {
                      $("#selectDealerSelection").append('<option value="" selected >CHOOSE</option>');
                  }
                  else {
                      $("#selectDealerSelection").append('<option value=""  >CHOOSE</option>');
                  }
                  $.each(Dealers, function (index, dealer) {
                      var selected = '';
                      if (dealer != null) {
                          selected = '';
                          if (dealer.name == dealerName) {
                              selected = 'selected';
                          }

                          $("#selectDealerSelection").append('<option value="' + dealer.name + '" ' + selected + ' >' + dealer.name + '</option>');
                          //$("#selectDealerSelection").append('<option value="' + dealer.name + '"  >' + dealer.name + '</option>');
                      }


                  });
                 $("#selectDealerSelection").selectmenu("refresh");

                  //get matching dealer
                  var filteredDealer = $.grep(Dealers, function (item) {
                      if (item != null) {
                          return item.name == dealerName;
                      }
                      return 0;
                  });

                  //update UI with data
                  // alert("index size " + filteredDealer.length.toString());
                  var index = 0;
                  if (filteredDealer.length > 0) {

                      if (filteredDealer[0] == null) {
                          //|| filteredDealer[0].profit == null) {

                          index = 1;
                      }

                      if (filteredDealer[index].profit == null || filteredDealer[index].profit == undefined) {
                          filteredDealer[index].profit = "0";
                      }
                      // alert("found " + dealerName + "index:" + index);


                      $("#inputProfitMarginOrMarkup").val(filteredDealer[index].profit);


                      //$("#inputMarkup").val(filteredDealer[index].markup);

                      //setCheckedAttr("radioProfitMargin", filteredDealer[index].useprofit);

                      if (filteredDealer[index].useprofit.toLowerCase() == "true") {
                          setCheckedAttr("radioMarkup", "false");
                          setCheckedAttr("radioProfitMargin", "true");
                      }
                      else {
                          setCheckedAttr("radioMarkup", "true");
                          setCheckedAttr("radioProfitMargin", "false");
                      }


                      //if (filteredDealer[index].carpetonly.toLowerCase() == "true") {
                      //    setCheckedAttr("radioCarpetOnly", "true");
                      //    setCheckedAttr("radioInstalled", "false");
                      //}
                      //else {
                      //    setCheckedAttr("radioCarpetOnly", "false");
                      //    setCheckedAttr("radioInstalled", "true");
                      //}


                      $("#inputCushion").val(filteredDealer[index].cushion);
                      setCheckedAttr("checkboxCushion", filteredDealer[index].usecushion);
                      //setDisabledByCheckBox("inputCushion", filteredDealer[index].usecushion);

                      $("#inputInstallation").val(filteredDealer[index].installation);
                      setCheckedAttr("checkboxInstallation", filteredDealer[index].useinstallation);
                      //setDisabledByCheckBox("inputInstallation", filteredDealer[index].useinstallation);

                      $("#inputFreight").val(filteredDealer[index].freight);
                      setCheckedAttr("checkboxFreight", filteredDealer[index].usefreight);
                      // setDisabledByCheckBox("inputFreight", filteredDealer[index].usefreight);

                      $("#inputOther").val(filteredDealer[index].other);

                      setCheckedAttr("checkboxOther", filteredDealer[index].useother);
                      //setDisabledByCheckBox("inputOther", filteredDealer[index].useother);



                      //$('#checkboxCushion').trigger('create');


                  }

                  setWholesaleData(dealerName);
                  setRetailData(dealerName);


              }


              function addDealer(dealerName, profitMargin, markup, useProfit, carpetonly, cushion, useCushion, installation, useInstallation, freight, useFreight, other, useOther) {
                  //get Dealers from storage
                  var Dealers = $.makeArray($.Dealer);
                  var data = localStorage['mohawkDealers']

                  if (data != undefined && data != null && data != "") {
                      Dealers = JSON.parse(data);

                      //get matching dealer
                      var filteredDealer = $.grep(Dealers, function (item) {
                          if (item != null) {
                              return item.name == dealerName;
                          }
                          return 0;
                      });

                      //update UI with data
                      if (filteredDealer.length > 0) {
                          //alert(dealerName + " already exist");
                          return;
                      }
                  }
                  //create new dealer
                  var myDealer = new $.Dealer(dealerName, profitMargin, markup, useProfit, carpetonly, cushion, useCushion, installation, useInstallation, freight, useFreight, other, useOther);
                  Dealers.push(myDealer);


                  Dealers.sort(function (obj1, obj2) {
                      if (obj1 == null) {
                          return true;
                      }
                      if (obj2 == null) {
                          return false;
                      }

                      if (obj1.name == '') {
                          return true;
                      }

                      if (obj2.name == '') {
                          return false;
                      }

                      return obj1.name > obj2.name;
                  });


                  //save to storage
                  localStorage['mohawkDealers'] = JSON.stringify(Dealers);

              }

              function getDealerObject(dealerName) {
                  //get Dealer from storage
                  var Dealers = $.makeArray($.Dealer);
                  var data = localStorage['mohawkDealers']
                  if (data == undefined || data == null || data == "") {
                      return null
                  }
                  Dealers = JSON.parse(data);

                  //get matching dealer
                  var filteredDealer = $.grep(Dealers, function (item) {
                      if (item != null) {
                          return item.name == dealerName;
                      }
                      return 0;
                  });


                  if (filteredDealer.length >= 1) {

                      return filteredDealer[0];
                  }
                  return null;

              }

              function deleteDealer(dealerName, profitMargin, markup, useProfit, carpetonly, cushion, useCushion, installation, useInstallation, freight, useFreight, other, useOther) {
                  //get Dealers from storage
                  var Dealers = $.makeArray($.Dealer);
                  var data = localStorage['mohawkDealers']

                  if (data == undefined && data == null && data == "") {
                      return;
                  }

                  Dealers = JSON.parse(data);

                  //get matching dealer
                  var filteredDealer = $.grep(Dealers, function (item) {
                      if (item != null) {
                          return item.name != dealerName;
                      }
                      return 0;
                  });


                  //if (filteredDealer.length < 1) {

                  //    return;
                  //}

                  if (filteredDealer.length > 0) {
                      filteredDealer.sort(function (obj1, obj2) {
                          if (obj1 == null) {
                              return true;
                          }
                          if (obj2 == null) {
                              return false;
                          }

                          if (obj1.name == '') {
                              return true;
                          }

                          if (obj2.name == '') {
                              return false;
                          }

                          return obj1.name > obj2.name;
                      });
                  }

                  //save to storage
                  localStorage['mohawkDealers'] = JSON.stringify(filteredDealer);

                  deleteWholesaleByDealerName(dealerName);
                  deleteRetailByDealerName(dealerName);

              }





              function saveDealer(selectedDealerName, dealerName, profitMargin, markup, useProfit, carpetonly, cushion, useCushion, installation, useInstallation, freight, useFreight, other, useOther) {
                  //get Dealers from storage
                  var Dealers = $.makeArray($.Dealer);
                  var data = localStorage['mohawkDealers']
                  var filteredDealer;

                  if (dealerName == null || dealerName == '') {
                      $("#popUpEnterDealerName").popup("open");
                      return;
                  }

                  if (data != undefined && data != null && data != "") {

                      Dealers = JSON.parse(data);

                      //get matching dealer
                      filteredDealer = $.grep(Dealers, function (item) {
                          if (item != null) {
                              return item.name != selectedDealerName;
                          }
                          return 0;
                      });


                      if (filteredDealer.length < 0) {

                          return;
                      }
                  }
                  else {
                      var filteredDealer = $.makeArray($.Dealer);
                  }
                  //create new dealer
                  var myDealer = new $.Dealer(dealerName, profitMargin, markup, useProfit, carpetonly, cushion, useCushion, installation, useInstallation, freight, useFreight, other, useOther);
                  filteredDealer.push(myDealer);



                  filteredDealer.sort(function (obj1, obj2) {
                      if (obj1 == null) {
                          return true;
                      }
                      if (obj2 == null) {
                          return false;
                      }

                      if (obj1.name == '') {
                          return true;
                      }

                      if (obj2.name == '') {
                          return false;
                      }

                      return obj1.name > obj2.name;
                  });


                  //save to storage
                  localStorage['mohawkDealers'] = JSON.stringify(filteredDealer);

              }


              function onAddDealerClick() {
                  var dealerName = $("#inputDealerSelection").val();
                  var profitMargin = $("#inputProfitMargin").val();
                  var markup = $("#inputMarkup").val();
                  var useProfit = $("#radioProfitMargin").is(':checked').toString();
                  var carpetonly = $("#radioCarpetOnly").is(':checked').toString();
                  var cushion = $("#inputCushion").val();
                  var useCushion = $("#checkboxCushion").is(':checked').toString();
                  var installation = $("#inputInstallation").val();;
                  var useInstallation = $("#checkboxInstallation").is(':checked').toString();
                  var freight = $("#inputFreight").val();
                  var useFreight = $("#checkboxFreight").is(':checked').toString();;;
                  var other = $("#inputOther").val();
                  var useOther = $("#checkboxOther").is(':checked').toString();;

                  addDealer(dealerName, profitMargin, markup, useProfit, carpetonly, cushion, useCushion, installation, useInstallation, freight, useFreight, other, useOther);
                  setDealerData(dealerName);
                  hideButtons();
              }

              function onSaveDealerClick() {
                  var selectedDealerName = $("#selectDealerSelection").val();
                  var dealerName = $("#inputDealerSelection").val();
                  if (dealerName == null || dealerName == '') {
                      $("#popUpEnterDealerName").popup("open");
                      return;
                  }

                  var profitMargin = $("#inputProfitMarginOrMarkup").val();
                  var carpetonly = $("#radioCarpetOnly").is(':checked').toString();
                  var markup = $("#inputProfitMarginOrMarkup").val();
                  var useProfit = $("#radioProfitMargin").is(':checked').toString();
                  var cushion = $("#inputCushion").val();
                  var useCushion = $("#checkboxCushion").is(':checked').toString();
                  var installation = $("#inputInstallation").val();;
                  var useInstallation = $("#checkboxInstallation").is(':checked').toString();
                  var freight = $("#inputFreight").val();
                  var useFreight = $("#checkboxFreight").is(':checked').toString();
                  var other = $("#inputOther").val();
                  var useOther = $("#checkboxOther").is(':checked').toString();

                  if (profitMargin == 'undefined') {
                      profitMargin = "0";
                  }

                  saveDealer(selectedDealerName, dealerName, profitMargin, markup, useProfit, carpetonly, cushion, useCushion, installation, useInstallation, freight, useFreight, other, useOther);
                  setDealerData(dealerName);
                  hideButtons();
              }

              function onCancelDealerClick() {
                  var dealerName = $("#inputDealerSelection").val();
                  setDealerData(dealerName);
                  hideButtons();
                  //showButtons();
              }
              function onDeleteDealerClick() {
                  var selectedDealerName = $("#selectDealerSelection").val();
                  var dealerName = $("#inputDealerSelection").val();
                  var profitMargin = $("#inputProfitMargin").val();
                  var carpetonly = $("#radioCarpetOnly").is(':checked').toString();
                  var markup = $("#inputMarkup").val();
                  var useProfit = $("#radioProfitMargin").is(':checked').toString();
                  var cushion = $("#inputCushion").val();
                  var useCushion = $("#checkboxCushion").is(':checked').toString();
                  var installation = $("#inputInstallation").val();;
                  var useInstallation = $("#checkboxInstallation").is(':checked').toString();
                  var freight = $("#inputFreight").val();
                  var useFreight = $("#checkboxFreight").is(':checked').toString();;;
                  var other = $("#inputOther").val();
                  var useOther = $("#checkboxOther").is(':checked').toString();;

                  deleteDealer(dealerName, profitMargin, markup, useProfit, carpetonly, cushion, useCushion, installation, useInstallation, freight, useFreight, other, useOther);
                  setDealerData(dealerName);
                  hideButtons();
              }





              function hideButtons() {
                  //  $('#inputDealerSelection').removeClass("ui-hidden-accessible");

                  //$("#inputBtnAdd").attr('hidden', 'hidden');
                  //$("#inputBtnSave").attr('hidden', 'hidden');
                  //$("#inputBtnCancel").attr('hidden', 'hidden');
                  //$("#inputBtnDelete").attr('hidden', 'hidden');
                  //$("#selectDealerSelection").prop('hidden', false);//Chrome
                  //$("#selectDealerSelection").attr('hidden', 'hidden'); //IE on <select> tag
                  //$("#selectDealerSelection").removeAttr('hidden');
                  //$("#inputDealerSelection").attr('hidden', 'hidden');

              }

              function toBool(str) {
                  return str.toLowerCase() == "true";
              }

              function setChecked(elmentName, trueFalseString) {
                  if (toBool(trueFalseString)) {
                      $("#" + elmentName).prop('checked', true);;
                  }
                  else {
                      $("#" + elmentName).prop('checked', false);
                  }
              }

              function setCheckedAttr(elmentName, trueFalseString) {
                  if (toBool(trueFalseString)) {
                      $("#" + elmentName).attr('checked', 'checked');

                      $("#" + elmentName).checkboxradio("refresh");

                  }
                  else {
                      $("#" + elmentName).removeAttr('checked');
                      $("#" + elmentName).checkboxradio("refresh");
                      // $("#" + elmentName).attr("checked", false).checkboxradio("refresh");
                  }
              }

              function setDisabledByCheckBox(elementName, stringCheckBoxValue) {
                  if (toBool(stringCheckBoxValue) == true) {
                      setDisabled(elementName, 'false');
                  }
                  else {
                      setDisabled(elementName, 'true');
                  }
              }

              function setDisabled(elmentName, trueFalseString) {
                  if (toBool(trueFalseString)) {
                      $("#" + elmentName).prop('disabled', true);;
                  }
                  else {
                      $("#" + elmentName).prop('disabled', false);
                  }
              }

              function setDisabledAttr(elmentName, trueFalseString) {
                  if (toBool(trueFalseString)) {
                      $("#" + elmentName).attr('disabled', 'disabled');;
                  }
                  else {
                      $("#" + elmentName).removeAttr('disabled');
                  }
              }


          </script>

	</body>
</html>
